apiVersion: v1
kind: ConfigMap
metadata:
  name: nginx-config
data:
  # Este é o nome do arquivo que o Nginx vai ler
  default.conf: |
    # Este é o conteúdo do seu arquivo, com a correção para /metrics
    server {
        listen 80;

        # Rota principal para seu app Node.js
        location / {
            proxy_pass http://grafeno-service:3123;
        }

        # Rota para as métricas do seu app Node.js
        location /metrics {
            proxy_pass http://grafeno-service:3123;
        }

        # Rota para o Grafana
        location /grafana/ {
            proxy_pass http://grafana:3000;
            proxy_set_header Host $host;
        }
    }